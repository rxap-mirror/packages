include:
  - local: .gitlab/ci/jobs/build.yaml
  - local: .gitlab/ci/jobs/docker.yaml
  - local: .gitlab/ci/jobs/sentry.yaml

stages:
  - build
  - docker
  - sentry

variables:
  ENVIRONMENT_NAME: release/$CI_COMMIT_TAG

build:
  extends: .build
  variables:
    ADDITIONAL_TARGET_OPTIONS: "--configuration production --channel $CI_ENVIRONMENT_SLUG"
  environment:
    name: $ENVIRONMENT_NAME

sentry:
  extends: .sentry
  environment:
    name: $ENVIRONMENT_NAME
