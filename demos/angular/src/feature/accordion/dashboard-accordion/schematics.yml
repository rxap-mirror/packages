$schema: "../../../../../../node_modules/@rxap/schematic-angular/src/schema.json"
package: "@rxap/schematic-angular"
name: accordion-component
options:
  name: dashboard
  backend: nestjs
  multiple: true
  header:
    property:
      name: name
  persistent:
    property:
      name: uuid
  identifier:
    source: route
    property:
      name: uuid
  upstream:
    kind: open-api
    operationId: dashboard-controller-getByUuid@legacy
  itemList:
    - name: general-information
      kind: switch
      switch:
        property:
          name: dashboardType
          type: number
        defaultCase:
          itemList:
            - kind: data-grid
              name: dashboard
              title: Allgemeine Informationen
              upstream:
                kind: open-api
                operationId: dashboard-controller-getByUuid@legacy
              dataGrid:
                mode: form
                itemList:
                  - name: name
                    hasCellDef: true
                    formControl:
                      kind: input
                  - name: location
                    pipeList:
                      - name: company
                        namedImport: CompanyPipe
                        moduleSpecifier: "@digitaix/eurogard-pipes"
                      - async
                      - getFromObject:name
                    formControl:
                      #kind: autocomplete-table-select
                      kind: table-select
                      toValue:
                        property:
                          name: uuid
                      columnList:
                        - name: name
                          hasFilter: true
                      upstream:
                        kind: open-api
                        operationId: company-gui-controller-getByFilter@legacy
                        mapper:
                          pageIndex: page
                          pageSize: size
                          sortBy: sort
                          sortDirection: order
                          list: entities
                          total: maxCount
                          filter:
                            eq: ':'
                            join: ';'
                  - name: link
                    kind: link
                    target: _blank
                    formControl:
                      kind: input
                      inputType: url
                  - name: company
                    type: string
                    isReadonly: true
                    pipeList:
                      - name: company
                        namedImport: CompanyPipe
                        moduleSpecifier: "@digitaix/eurogard-pipes"
                      - async
                      - "getFromObject:'name'"
                  - name: dashboardType
                    header: Typ
                    type: number
                    isReadonly: true
                    pipeList:
                      - name: toDashboardTypesEnumValue
                        namedImport: ToDashboardTypesEnumValuePipe
                        moduleSpecifier: enum
                      - async
        case:
          - test: 2
            itemList:
              - kind: data-grid
                name: cloud-dashboard
                title: Allgemeine Informationen
                upstream:
                  kind: open-api
                  operationId: dashboard-controller-getByUuid@legacy
                dataGrid:
                  mode: form
                  itemList:
                    - name: name
                      hasCellDef: true
                      formControl:
                        kind: input
                    - name: company
                      type: string
                      isReadonly: true
                      pipeList:
                        - name: company
                          namedImport: CompanyPipe
                          moduleSpecifier: "@digitaix/eurogard-pipes"
                        - async
                        - "getFromObject:'name'"
                    - name: dashboardType
                      header: Typ
                      type: number
                      isReadonly: true
                      pipeList:
                        - name: toDashboardTypesEnumValue
                          namedImport: ToDashboardTypesEnumValuePipe
                          moduleSpecifier: enum
                        - async
    - name: layout
      kind: switch
      permission: dashboard.layout.get
      switch:
        property:
          name: dashboardType
          type: number
        case:
          - test: 2
            upstream:
              kind: open-api
              operationId: dashboard-controller-getByUuid@legacy
            itemList:
              - name: cloud-dashboard
                title: Layouts
    - name: reference
      kind: tree-table
      title: Zuordnung
      table:
        propertyList:
          - name: uuid
        columnList:
          - name: referenced
            type: boolean
            filterControl:
              name: referenced
              kind: checkbox
          - name: name
            filterControl:
              name: name
              kind: input
            type: string
          - name: type
            type: string
